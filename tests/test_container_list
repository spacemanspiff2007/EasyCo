import unittest

from EasyCo import ConfigContainer, EasyCoConfig, ContainerList

CFG_TEST = EasyCoConfig()


class TestContainer(ConfigContainer):
    TYPE_HINT_AND_VALUE: float = 0
    ONLY_TYPE_HINT: int
    ONLY_VALUE = 7.5

    def function_b(self) -> bool:
        pass


class TestParentContainer(ConfigContainer):
    TEST_INT = 5
    TOP_CONTAINER = TestContainer()

    # config should be found
    __cfg = CFG_TEST


class test_container(unittest.TestCase):

    def cross_test(self, obj, obj2):
        for key in obj:
            self.assertIn(key, obj2)
        for key in obj2:
            self.assertIn(key, obj)

    def test_flat_keys(self):
        schema = {}
        CFG_TEST.lower_case_keys = False
        TestContainer()._update_schema(schema, insert=False)

        for key in schema.keys():
            self.assertIn(key, ['TYPE_HINT_AND_VALUE', 'ONLY_TYPE_HINT', 'ONLY_VALUE'])

        schema = {}
        CFG_TEST.lower_case_keys = True
        TestContainer()._update_schema(schema, insert=False)

        self.cross_test(schema, ['type_hint_and_value', 'only_type_hint', 'only_value'])


if __name__ == "__main__":
    unittest.main()
